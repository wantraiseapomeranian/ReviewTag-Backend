sequenceDiagram
    autonumber
    actor User as 👤 사용자
    participant React as ⚛️ React (Client)
    participant Spring as 🍃 Spring Boot (Server)
    participant TMDB as 🎬 TMDB API (External)
    participant DB as 💾 Oracle DB

    %% 1단계: 검색 프로세스
    Note over User, DB: 1단계: TMDB 실시간 검색 (데이터 수집 전)
    User->>React: 검색어 입력
    React->>Spring: 검색 요청 (GET /search/{query})
    activate Spring
    Spring->>TMDB: 검색 API 호출
    activate TMDB
    TMDB-->>Spring: 검색 결과 JSON
    deactivate TMDB
    Spring-->>React: 결과 리스트 반환
    deactivate Spring
    React-->>User: 컨텐츠 목록 표시

    %% 2단계: 저장 프로세스 (Controller 반영)
    Note over User, DB: 2단계: 컨텐츠 선택 및 DB 저장 (POST /save)
    User->>React: 컨텐츠 클릭
    
    %% React에서 저장 요청
    React->>Spring: POST /save (SaveRequestVO)
    activate Spring
    
    Note right of Spring: Service: 상세 조회 후 DB Merge
    Spring->>TMDB: Service: API로 상세 정보 요청 
    activate TMDB
    TMDB-->>Spring: 상세 데이터 JSON
    deactivate TMDB

    Spring->>DB: MERGE INTO 실행 (Upsert)
    activate DB
    Note right of DB: DB에 없으면 INSERT<br/>있으면 UPDATE
    DB-->>Spring: 저장 완료
    deactivate DB

    Spring-->>React: 200 OK (ContentsDetailDto)
    deactivate Spring

    %% 3단계: 상세 페이지 이동 및 조회
    Note over User, DB: 3단계: 상세 페이지 이동 및 조회 (useEffect)
    
    React->>React: 상세 페이지로 이동 (Navigate)
    
    Note right of React: 페이지 마운트 시 useEffect 실행
    React->>Spring: 상세 정보 조회 요청 (GET /contents/detail/{contentsId})
    activate Spring
    
    Spring->>DB: SELECT (저장된 데이터 조회)
    activate DB
    DB-->>Spring: 컨텐츠 정보 반환
    deactivate DB
    
    Spring-->>React: 상세 정보 응답
    deactivate Spring
    
    React-->>User: 상세 페이지 렌더링